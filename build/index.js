(()=>{"use strict";const e=window.wp.element,t=window.lodash,o=window.wp.i18n,n=window.wp.hooks,s=window.wp.components,r=window.wp.blockEditor,l=window.wp.compose,p=window.wp.data,i=window.wp.dom,a=function(n){const[r,l]=(0,e.useState)(""),[a,c]=(0,e.useState)([]),{posts:u}=(0,p.useSelect)((e=>{const t=["postType",n.postType,{search:r,search_columns:["post_title"]}];return{posts:e("core").getEntityRecords(...t)}}),[r,n.postType]),d=e=>(0,t.unescape)((0,i.safeHTML)(e)),m=Array.isArray(u)?u:[],w=(m.map((e=>e?.id)),m.map((e=>e?.title?.rendered)).map(d)),y=n.value.map((e=>e.title)).map(d),g=(0,t.capitalize)(n.postType);return(0,e.createElement)("div",{className:"qlpsp-post-selector"},(0,e.createElement)(s.FormTokenField,{suggestions:w,value:y,__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,__experimentalRenderItem:({item:t})=>(0,e.createElement)("span",null,d(t)),onInputChange:l,label:g,placeholder:(0,o.sprintf)((0,o.__)("Select %s","query-loop-post-selector"),n.postType),onChange:e=>{const t=e.map((e=>{const t=n.value.find((t=>t?.title===e));if(t)return t;const o=u.find((t=>d(t?.title?.rendered)===e));return{title:e,id:o?.id}}));n.onChange(t)}}))},c=(0,l.createHigherOrderComponent)((n=>l=>{const p=(0,e.useRef)(!0),i=(0,t.get)(l,"attributes.query.postType","post"),c=(0,t.get)(l,"attributes.query",{}),u=(0,t.get)(c,"qlpspSelectivePosts",[]),d=(0,t.get)(c,"inherit",!1);return(0,e.useEffect)((()=>{p.current?p.current=!1:l.setAttributes({query:{...c,qlpspSelectivePosts:[]}})}),[i,d]),"core/query"!==l.name?(0,e.createElement)(n,{...l}):(0,e.createElement)(e.Fragment,null,(0,e.createElement)(n,{...l}),!d&&(0,e.createElement)(r.InspectorControls,null,(0,e.createElement)(s.PanelBody,{title:(0,o.__)("Selective Posts","query-loop-post-selector")},(0,e.createElement)(a,{postType:i,value:u,onChange:e=>l.setAttributes({query:{...c,qlpspSelectivePosts:e}})}))))}),"withSelectivePostControl");(0,n.addFilter)("editor.BlockEdit","small-plugins/with-query-loop-selective-post-control",c)})();